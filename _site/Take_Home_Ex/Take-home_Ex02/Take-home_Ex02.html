<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.326">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yap Pin Yaw">

<title>ISSS608-VAA - Take Home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_class_Ex/In-class_Ex08/In-class_Ex08.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#methodology-objective" id="toc-methodology-objective" class="nav-link" data-scroll-target="#methodology-objective">2. Methodology &amp; Objective</a></li>
  <li><a href="#data-preperation" id="toc-data-preperation" class="nav-link" data-scroll-target="#data-preperation">3. Data Preperation</a>
  <ul class="collapse">
  <li><a href="#load-install-packages" id="toc-load-install-packages" class="nav-link" data-scroll-target="#load-install-packages">3.1 Load &amp; Install Packages</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">3.2 Import Data</a></li>
  <li><a href="#data-attribute" id="toc-data-attribute" class="nav-link" data-scroll-target="#data-attribute">3.3 Data Attribute</a>
  <ul class="collapse">
  <li><a href="#node-attribute" id="toc-node-attribute" class="nav-link" data-scroll-target="#node-attribute">3.3.1 Node Attribute</a></li>
  <li><a href="#edge-attribute" id="toc-edge-attribute" class="nav-link" data-scroll-target="#edge-attribute">3.3.2 Edge Attribute</a></li>
  </ul></li>
  <li><a href="#data-extraction" id="toc-data-extraction" class="nav-link" data-scroll-target="#data-extraction">3.4 Data Extraction</a></li>
  <li><a href="#data-wrangling-aggregation" id="toc-data-wrangling-aggregation" class="nav-link" data-scroll-target="#data-wrangling-aggregation">3.5 Data Wrangling &amp; Aggregation</a>
  <ul class="collapse">
  <li><a href="#preparing-the-edges" id="toc-preparing-the-edges" class="nav-link" data-scroll-target="#preparing-the-edges">3.5.1 Preparing the edges</a></li>
  <li><a href="#preparing-the-nodes" id="toc-preparing-the-nodes" class="nav-link" data-scroll-target="#preparing-the-nodes">3.5.2 Preparing the nodes</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualization-data-analysis" id="toc-visualization-data-analysis" class="nav-link" data-scroll-target="#visualization-data-analysis">4. Visualization &amp; Data Analysis</a>
  <ul class="collapse">
  <li><a href="#using-tidygraph-to-plot-the-network" id="toc-using-tidygraph-to-plot-the-network" class="nav-link" data-scroll-target="#using-tidygraph-to-plot-the-network">4.1 Using tidygraph to plot the network</a></li>
  <li><a href="#network-graph" id="toc-network-graph" class="nav-link" data-scroll-target="#network-graph">4.2 Network Graph</a></li>
  <li><a href="#plot-analysis" id="toc-plot-analysis" class="nav-link" data-scroll-target="#plot-analysis">4.3 Plot Analysis</a>
  <ul class="collapse">
  <li><a href="#hscode-304620-2" id="toc-hscode-304620-2" class="nav-link" data-scroll-target="#hscode-304620-2">4.3.1 HSCode 304620</a></li>
  <li><a href="#hscode-630900-2" id="toc-hscode-630900-2" class="nav-link" data-scroll-target="#hscode-630900-2">4.3.1 HSCode 630900</a></li>
  </ul></li>
  <li><a href="#insights-and-learning-points" id="toc-insights-and-learning-points" class="nav-link" data-scroll-target="#insights-and-learning-points">5. Insights and Learning points</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yap Pin Yaw </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<p>With reference to the first point of Tasks and Questions under the Mini-Challenge 2 of VAST Challenge 2023. This webpage will be focusing on using visual analytics to identify temporal patterns for individual entities and between entities in the knowledge graph FishEye created from trade records.</p>
</section>
<section id="methodology-objective" class="level1">
<h1>2. Methodology &amp; Objective</h1>
<p>In order to identify the temporal patterns, I will be using the knowledge graph of MC2 as well as the other relevant fish bundles to observe the relationship between the existing entities.</p>
</section>
<section id="data-preperation" class="level1">
<h1>3. Data Preperation</h1>
<section id="load-install-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-install-packages">3.1 Load &amp; Install Packages</h2>
<p>The following code chunk will load and install the necessary packages</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">:::</span><span class="fu">p_load</span>(jsonlite, tidygraph, ggraph, visNetwork, lubridate, tidyverse, networkD3, igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">3.2 Import Data</h2>
<p>Since the raw data obtained from the VAST Challenge are in <code>json</code> format, <code>fromJSON</code> is being used to extract the data information. All the bundles files are being extracted as well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC2 <span class="ot">&lt;-</span><span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-attribute" class="level2">
<h2 class="anchored" data-anchor-id="data-attribute">3.3 Data Attribute</h2>
<section id="node-attribute" class="level3">
<h3 class="anchored" data-anchor-id="node-attribute">3.3.1 Node Attribute</h3>
<table class="table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>Node Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>id</td>
<td>chr</td>
<td>Name of the company that originated (or received) the shipment</td>
</tr>
<tr class="even">
<td>shpcountry</td>
<td>chr</td>
<td>Country the company most often associated with when shipping</td>
</tr>
<tr class="odd">
<td>rcvcountry</td>
<td>chr</td>
<td>Country the company most often associated with when receiving</td>
</tr>
</tbody>
</table>
</section>
<section id="edge-attribute" class="level3">
<h3 class="anchored" data-anchor-id="edge-attribute">3.3.2 Edge Attribute</h3>
<table class="table">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 53%">
</colgroup>
<thead>
<tr class="header">
<th>Edge Name</th>
<th>Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>source</td>
<td>chr</td>
<td>Name of the company that originated the shipment</td>
</tr>
<tr class="even">
<td>target</td>
<td>chr</td>
<td>Name of the company that received the shipment</td>
</tr>
<tr class="odd">
<td>arrivaldate</td>
<td>chr</td>
<td>Date the shipment arrived at port in YYYY-MM-DD format</td>
</tr>
<tr class="even">
<td>hscode</td>
<td>chr</td>
<td>Harmonized System code for the shipment. Can be joined with the hscodes table to get additional details</td>
</tr>
<tr class="odd">
<td>valueofgoods_omu</td>
<td>num</td>
<td>Customs-declared value of the total shipment, in Oceanus Monetary Units (OMU)</td>
</tr>
<tr class="even">
<td>volumeteu</td>
<td>num</td>
<td>The volume of the shipment in ‘Twenty-foot equivalent units’, roughly how many 20-foot standard containers would be required. (Actual number of containers may have been different as there are 20ft and 40ft standard containers and tankers that do not use containers)</td>
</tr>
<tr class="odd">
<td>weightkg</td>
<td>int</td>
<td>The weight of the shipment in kilograms (if known) ## 3.4 Nodes &amp; Edges Extraction</td>
</tr>
<tr class="even">
<td>valueofgoodsusd</td>
<td>num</td>
<td>valueofgoods_omu in USD</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="data-extraction" class="level2">
<h2 class="anchored" data-anchor-id="data-extraction">3.4 Data Extraction</h2>
<p><code>as_tibble()</code> function to turn the nodes and edges from MC2 into a data frame.</p>
<p>The <code>lubridate</code> package is utilized to determine the various types of days for analysis. In our analysis, <code>ymd()</code> is being used to convert <code>arrivaldate</code> field from character data type to date data type. While <code>year()</code> is being used to extract the only year value based on the arrival date.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Nodes</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Edges</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>MC2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC2<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span> (id, shpcountry, rcvcountry) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>MC2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span> (id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34,576 × 3
   id                                           shpcountry     rcvcountry  
   &lt;chr&gt;                                        &lt;chr&gt;          &lt;chr&gt;       
 1 " Direct Herring Company Transit"            Mawazam        Coralmarica 
 2 " Direct LLC Marine biology"                 Marebak        Oceanus     
 3 " Direct Limited Liability Company"          Icarnia        Coralmarica 
 4 " Direct Limited Liability Company Shipping" Kondanovia     Oceanus     
 5 " Direct S.A. de C.V."                       Marebak        Oceanus     
 6 " Direct Shark Oyj Marine sanctuary"         Mawazam        Thessalandia
 7 " Direct Starfish Inc Worldwide"             Puerto del Mar Oceanus     
 8 "-1"                                         Playa Solis    &lt;NA&gt;        
 9 "-10"                                        Utoporiana     &lt;NA&gt;        
10 "-100"                                       &lt;NA&gt;           Oceanus     
# ℹ 34,566 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MC2_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC2<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ArrivalDate =</span> <span class="fu">ymd</span>(arrivaldate)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(ArrivalDate)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(source, target, ArrivalDate, Year, hscode, valueofgoods_omu, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         volumeteu, weightkg, valueofgoodsusd) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># to remove those are without values</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(valueofgoods_omu) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(valueofgoodsusd)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NULL values with a specific value</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>replacement_value <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>MC2_edges <span class="ot">&lt;-</span> <span class="fu">replace</span>(MC2_edges, <span class="fu">is.null</span>(MC2_edges), replacement_value)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>MC2_edges</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,423,113 × 9
   source    target ArrivalDate  Year hscode valueofgoods_omu volumeteu weightkg
   &lt;chr&gt;     &lt;chr&gt;  &lt;date&gt;      &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;    &lt;int&gt;
 1 AquaDeli… Barin… 2034-02-12   2034 630630           141015         0     4780
 2 AquaDeli… Barin… 2034-03-13   2034 630630           141015         0     6125
 3 AquaDeli… Océan… 2028-04-12   2028 304890               NA         0     9000
 4 AquaDeli… Olas … 2028-06-04   2028 304890               NA         0    19490
 5 AquaDeli… Shou … 2028-09-08   2028 306170               NA         0    19065
 6 AquaDeli… Costa… 2029-02-04   2029 304790               NA         0     9885
 7 AquaDeli… Costa… 2029-02-04   2029 304790               NA         0     9880
 8 AquaDeli… Elara… 2029-04-22   2029 304620               NA         0    18210
 9 AquaDeli… Elara… 2029-04-22   2029 304620               NA         0    18200
10 AquaDeli… Fishe… 2030-03-10   2030 304990               NA         0    21910
# ℹ 2,423,103 more rows
# ℹ 1 more variable: valueofgoodsusd &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>as_tibble()</code> turns an existing object, such as a data frame or matrix, into a so-called tibble, a data frame with class tbl_df</p>
<p><code>select()</code> is used not only to select the field needed but also to re-organise the sequence of the fields</p>
</div>
</div>
</section>
<section id="data-wrangling-aggregation" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling-aggregation">3.5 Data Wrangling &amp; Aggregation</h2>
<section id="preparing-the-edges" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-edges">3.5.1 Preparing the edges</h3>
<p>Due to the scale of the network from MC2 data, the direction in this exercise will only be focusing on the top hscodes across the years and explore the pattern change.</p>
<section id="years-available" class="level4">
<h4 class="anchored" data-anchor-id="years-available">3.5.1.1 Years Available</h4>
<p>First we identify the Years that are present in the data.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(MC2_edges<span class="sc">$</span>Year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2028 2029 2030 2031 2032 2033 2034</code></pre>
</div>
</div>
</section>
<section id="edges-filter-only-by-year" class="level4">
<h4 class="anchored" data-anchor-id="edges-filter-only-by-year">3.5.1.2 Edges Filter only by Year</h4>
<p>With the above information, next we looked into aggregate the data set by using <code>filter</code>to obtain each of the years data separately (from 2028 till 2034), followed by <code>group_by</code> function to get the count of occurrence (higher weight = higher transaction occurred).</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">2034</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2028 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2028"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2029<span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2029"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2030 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2030"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2031 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2031"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2032 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2032"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2033 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2033"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2034 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2034"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="top-hscodes-selection-across-the-years" class="level4">
<h4 class="anchored" data-anchor-id="top-hscodes-selection-across-the-years">3.5.1.3 Top hscodes selection across the years</h4>
<p>Moving forward, we used the aggregated data to obtain the top 5 source-target pair with the highest weight count so as to filter our analysis further to check of any patterns observed.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">2034</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2028_top5 <span class="ot">&lt;-</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_edges_aggregated_2028<span class="sc">$</span>hscode[<span class="fu">order</span>(MC2_edges_aggregated_2028<span class="sc">$</span>weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],<span class="dv">5</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2028_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "304620" "630900" "760120" "160414" "611595"</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2029_top5 <span class="ot">&lt;-</span> <span class="fu">head</span>(MC2_edges_aggregated_2029<span class="sc">$</span>hscode[<span class="fu">order</span>(MC2_edges_aggregated_2029<span class="sc">$</span>weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],<span class="dv">5</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2029_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "304620" "630900" "304620" "304620" "611595"</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2030_top5 <span class="ot">&lt;-</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_edges_aggregated_2030<span class="sc">$</span>hscode[<span class="fu">order</span>(MC2_edges_aggregated_2030<span class="sc">$</span>weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],<span class="dv">5</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2030_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "304620" "206100" "304620" "611020" "630900"</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2031_top5 <span class="ot">&lt;-</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_edges_aggregated_2031<span class="sc">$</span>hscode[<span class="fu">order</span>(MC2_edges_aggregated_2031<span class="sc">$</span>weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],<span class="dv">5</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2031_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "304620" "304620" "206100" "630900" "761010"</code></pre>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2032_top5 <span class="ot">&lt;-</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_edges_aggregated_2032<span class="sc">$</span>hscode[<span class="fu">order</span>(MC2_edges_aggregated_2032<span class="sc">$</span>weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],<span class="dv">5</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2032_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "304620" "611020" "206100" "304620" "304620"</code></pre>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2033_top5 <span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_edges_aggregated_2033<span class="sc">$</span>hscode[<span class="fu">order</span>(MC2_edges_aggregated_2033<span class="sc">$</span>weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],<span class="dv">5</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2033_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "304620" "304620" "206100" "730429" "304620"</code></pre>
</div>
</div>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-7-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2034_top5 <span class="ot">&lt;-</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MC2_edges_aggregated_2034<span class="sc">$</span>hscode[<span class="fu">order</span>(MC2_edges_aggregated_2034<span class="sc">$</span>weights, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)],<span class="dv">5</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2034_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "630900" "304620" "304620" "630140" "760120"</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The top 5 hscodes are then being placed together to form a dataframe.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_top5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MC2_edges_aggregated_2028_top5</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                                   , MC2_edges_aggregated_2029_top5</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                                   , MC2_edges_aggregated_2030_top5</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                                   , MC2_edges_aggregated_2031_top5</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                                   , MC2_edges_aggregated_2032_top5</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                                   , MC2_edges_aggregated_2033_top5</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                                   , MC2_edges_aggregated_2034_top5) </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                               [,1]     [,2]     [,3]     [,4]     [,5]    
MC2_edges_aggregated_2028_top5 "304620" "630900" "760120" "160414" "611595"
MC2_edges_aggregated_2029_top5 "304620" "630900" "304620" "304620" "611595"
MC2_edges_aggregated_2030_top5 "304620" "206100" "304620" "611020" "630900"
MC2_edges_aggregated_2031_top5 "304620" "304620" "206100" "630900" "761010"
MC2_edges_aggregated_2032_top5 "304620" "611020" "206100" "304620" "304620"
MC2_edges_aggregated_2033_top5 "304620" "304620" "206100" "730429" "304620"
MC2_edges_aggregated_2034_top5 "630900" "304620" "304620" "630140" "760120"</code></pre>
</div>
</div>
</section>
<section id="find-the-count-of-each-value-across-columns" class="level4">
<h4 class="anchored" data-anchor-id="find-the-count-of-each-value-across-columns">3.5.1.4 Find the count of each value across columns</h4>
<p>To identify which hscode has the highest occurrence, <code>unlist</code> are used to flatten the dataframe <code>MC2_edges_aggregated_2028_top5</code> into a single vector (<code>flat_data</code>).</p>
<p>Next, we apply the <code>table</code> function to <code>flat_data</code> to create a frequency table of the unique values, counting their occurrences across the entire dataframe. The resulting counts are stored in the counts variable.</p>
<p>Finally, we print the counts to see the count of each value across the entire dataframe. The output will display a table with rows representing unique values and the corresponding counts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the dataframe into a single vector</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>flat_data <span class="ot">&lt;-</span> <span class="fu">unlist</span>(MC2_edges_aggregated_top5)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the count of each value across the entire dataframe</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">table</span>(flat_data)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the counts</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>flat_data
160414 206100 304620 611020 611595 630140 630900 730429 760120 761010 
     1      4     16      2      2      1      5      1      2      1 </code></pre>
</div>
</div>
<p>From the above result, we are able to conclude that hscode (304620 : 16 , 630900 : 5) are the top 2 across the years. Therefore, we can filter the data further to explore the pattern network changes across the year.</p>
</section>
<section id="edges-filter-by-hscode-and-year" class="level4">
<h4 class="anchored" data-anchor-id="edges-filter-by-hscode-and-year">3.5.1.5 Edges Filter by hscode and Year</h4>
<p>With the information of the top 2 hscode, the data edges are being re-aggregated with the additional filter of hscode and year.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-7" role="tab" aria-controls="tabset-4-7" aria-selected="false">2034</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-8" role="tab" aria-controls="tabset-4-8" aria-selected="false">All edges</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2028_1 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"304620"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2028"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2028_2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"630900"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2028"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2029_1 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"304620"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2029"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2029_2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"630900"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2029"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2030_1 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"304620"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2030"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2030_2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"630900"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2030"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2031_1 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"304620"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2031"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2031_2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"630900"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2031"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2032_1 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"304620"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2032"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2032_2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"630900"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2032"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2033_1 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"304620"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2033"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2033_2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"630900"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2033"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2034_1 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"304620"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2034"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>MC2_edges_aggregated_2034_2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(hscode <span class="sc">==</span> <span class="st">"630900"</span> <span class="sc">&amp;</span> Year <span class="sc">==</span> <span class="st">"2034"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source, target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>MC2_edges_combined_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MC2_edges_aggregated_2028_1</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2029_1</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2030_1</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2031_1</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2032_1</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2033_1</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2034_1)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>MC2_edges_combined_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MC2_edges_aggregated_2028_2</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2029_2</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2030_2</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2031_2</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2032_2</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2033_2</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>                            , MC2_edges_aggregated_2034_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="preparing-the-nodes" class="level3">
<h3 class="anchored" data-anchor-id="preparing-the-nodes">3.5.2 Preparing the nodes</h3>
<p>Next, nodes are to be prepared based on the readied aggregated edges set.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false">2034</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-8" role="tab" aria-controls="tabset-5-8" aria-selected="false">All nodes</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2028_1 <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2028_1 <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2028_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2028_2 <span class="sc">%&gt;%</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2028_2 <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2028_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2029_1 <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2029_1 <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2029_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2029_2 <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2029_2 <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2029_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2030_1 <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2030_1 <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2030_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2030_2 <span class="sc">%&gt;%</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2030_2 <span class="sc">%&gt;%</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2030_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2031_1 <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2031_1 <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2031_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2031_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2031_2 <span class="sc">%&gt;%</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2031_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2032_1 <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2032_1 <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2032_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2032_2 <span class="sc">%&gt;%</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2032_2 <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2032_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2033_1 <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2033_1 <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2033_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2033_2 <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2033_2 <span class="sc">%&gt;%</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2033_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2034_1 <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2034_1 <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2034_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> MC2_edges_aggregated_2034_2 <span class="sc">%&gt;%</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> MC2_edges_aggregated_2034_2 <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>MC2_nodes_aggregated_2034_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1, id2) <span class="sc">%&gt;%</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 304620</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>MC2_nodes_combined_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MC2_nodes_aggregated_2028_1</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2029_1</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2030_1</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2031_1</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2032_1</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2033_1</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2034_1) <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">distinct</span>()</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="co"># HSCODE: 630900</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>MC2_nodes_combined_2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(MC2_nodes_aggregated_2028_2</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2029_2</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2030_2</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2031_2</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2032_2</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2033_2</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>                            , MC2_nodes_aggregated_2034_2) <span class="sc">%&gt;%</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="visualization-data-analysis" class="level1">
<h1>4. Visualization &amp; Data Analysis</h1>
<section id="using-tidygraph-to-plot-the-network" class="level2">
<h2 class="anchored" data-anchor-id="using-tidygraph-to-plot-the-network">4.1 Using tidygraph to plot the network</h2>
<p>The code chunk below is then used to build the tidy graph data model.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">hscode: 304620</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">hscode: 630900</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-7" role="tab" aria-controls="tabset-6-7" aria-selected="false">2034</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-8" role="tab" aria-controls="tabset-6-8" aria-selected="false">All combined</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2028_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2028_1,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2028_1, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2029_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2029_1,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2029_1, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2030_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2030_1,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2030_1, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2031_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2031_1,</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2031_1, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2032_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2032_1,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2032_1, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2033_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2033_1,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2033_1, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2034_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2034_1,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2034_1, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_combined_1 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_combined_1,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_combined_1, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-6" role="tab" aria-controls="tabset-7-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-7" role="tab" aria-controls="tabset-7-7" aria-selected="false">2034</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-8" role="tab" aria-controls="tabset-7-8" aria-selected="false">All Combined</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2028_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2028_2,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2028_2, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2029_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2029_2,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2029_2, </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2030_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2030_2,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2030_2, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2031_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2031_2,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2031_2, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2032_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2032_2,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2032_2, </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2033_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2033_2,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2033_2, </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_2034_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_aggregated_2034_2,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_aggregated_2034_2, </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>MC2_graph_combined_2 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> MC2_nodes_combined_2,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> MC2_edges_combined_2, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="network-graph" class="level2">
<h2 class="anchored" data-anchor-id="network-graph">4.2 Network Graph</h2>
<p>In order to narrow down the analysis and prioritize the most influential individuals within the interaction, the attention is being placed on the top 10% of vertices based on their eigenvector centrality score. Eigenvector centrality is a measure of the relative importance of each vertex in a graph based on its connections to other highly connected vertices. By identifying the quantile threshold using the quantile function applied to the <code>eigen_centrality</code> values of the graph, we can determine which vertices fall within the top 10% range.</p>
<p>Once we have identified these key vertices, we will remove the remaining vertices from the graph using the <code>delete_vertices</code> function. This step helps to streamline the visualization and analysis by excluding less influential individuals and reducing the complexity of the graph.</p>
<p>To present the resulting graph visually, the Fruchterman-Reingold layout algorithm <code>layout_with_fr</code> is being employed, which is commonly used for network graph visualization. This layout algorithm arranges the vertices in a way that minimizes the edge crossings and evenly distributes the vertices based on their connections.</p>
<p>In addition, to ensure reproducibility of the plot, the <code>set.seed</code> function is being used to recreate the same layout each time the graph is generated.</p>
<p>By focusing on the top 10% vertices based on eigenvector centrality, removing less influential vertices, and utilizing an effective layout algorithm, we can better understand the most influential individuals within the interaction network and facilitate a more focused analysis.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">hscode: 304620</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">hscode: 630900</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-6" role="tab" aria-controls="tabset-9-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-7" role="tab" aria-controls="tabset-9-7" aria-selected="false">2034</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-8" role="tab" aria-controls="tabset-9-8" aria-selected="false">All combined</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2028_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2028_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2028_1)<span class="sc">$</span>vector</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2028_1, <span class="fu">V</span>(MC2_graph_2028_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Arena del Sol Pic"         "Caracola del Sol Services"
[3] "Mar del Este CJSC"         "hǎi dǎn Corporation Wharf"</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2029_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2029_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2029_1)<span class="sc">$</span>vector</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2029_1, <span class="fu">V</span>(MC2_graph_2029_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sea Breezes S.A. de C.V. Freight " "Caracola del Sol Services"        
[3] "Mar del Este CJSC"                 "hǎi dǎn Corporation Wharf"        </code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2030_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2030_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2030_1)<span class="sc">$</span>vector</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2030_1, <span class="fu">V</span>(MC2_graph_2030_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Madhya Pradesh  Market LLC"        "Sea Breezes S.A. de C.V. Freight "
[3] "Mar del Este CJSC"                 "hǎi dǎn Corporation Wharf"        </code></pre>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2031_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2031_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2031_1)<span class="sc">$</span>vector</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2031_1, <span class="fu">V</span>(MC2_graph_2031_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Madhya Pradesh  Market LLC"        "Sea Breezes S.A. de C.V. Freight "
[3] "Mar del Este CJSC"                 "Caracola del Sol Services"        </code></pre>
</div>
</div>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2032_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2032_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2032_1)<span class="sc">$</span>vector</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2032_1, <span class="fu">V</span>(MC2_graph_2032_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sea Breezes S.A. de C.V. Freight " "Mar del Este CJSC"                
[3] "hǎi dǎn Corporation Wharf"        </code></pre>
</div>
</div>
</div>
<div id="tabset-9-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-6-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2033_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2033_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2033_1)<span class="sc">$</span>vector</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2033_1, <span class="fu">V</span>(MC2_graph_2033_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sea Breezes S.A. de C.V. Freight " "hǎi dǎn Corporation Wharf"        
[3] "Mar del Este CJSC"                </code></pre>
</div>
</div>
</div>
<div id="tabset-9-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-7-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2034_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2034_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2034_1)<span class="sc">$</span>vector</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2034_1, <span class="fu">V</span>(MC2_graph_2034_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Italian Sword Underwater Plc Enterprises"
[2] "Mar del Este CJSC"                       </code></pre>
</div>
</div>
</div>
<div id="tabset-9-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-8-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_combined_1)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_combined_1)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_combined_1)<span class="sc">$</span>vector</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_combined_1, <span class="fu">V</span>(MC2_graph_combined_1)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Arena del Sol Pic"                 "Konkan Coast  Dashi BV Investment"
 [3] "Madhya Pradesh  Market LLC"        "Sea Breezes S.A. de C.V. Freight "
 [5] "nián yú Ltd. Corporation"          "Caracola del Sol Services"        
 [7] "Mar del Este CJSC"                 "Selous Game Reserve  S.A. de C.V."
 [9] "hǎi dǎn Corporation Wharf"         "Costa de la Felicidad Shipping"   </code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">2028</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">2029</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">2030</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">2031</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-5" role="tab" aria-controls="tabset-10-5" aria-selected="false">2032</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-6" role="tab" aria-controls="tabset-10-6" aria-selected="false">2033</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-7" role="tab" aria-controls="tabset-10-7" aria-selected="false">2034</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-8" role="tab" aria-controls="tabset-10-8" aria-selected="false">All combined</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2028_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2028_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2028_2)<span class="sc">$</span>vector</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2028_2, <span class="fu">V</span>(MC2_graph_2028_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 630900 - Eigenvector centrality graph"</span> )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Playa del Mar NV"          "hǎi dǎn Corporation Wharf"</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2029_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2029_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2029_2)<span class="sc">$</span>vector</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2029_2, <span class="fu">V</span>(MC2_graph_2029_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Playa del Mar NV"                  "ReefRider Foods Ltd. Liability Co"</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2030_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2030_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2030_2)<span class="sc">$</span>vector</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2030_2, <span class="fu">V</span>(MC2_graph_2030_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Seashell Sanctum SRL Transport"      
[2] "Changsha Ltd. Liability Co Transport"</code></pre>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2031_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2031_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2031_2)<span class="sc">$</span>vector</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2031_2, <span class="fu">V</span>(MC2_graph_2031_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "East Ltd. Liability Co"    "hǎi dǎn Corporation Wharf"</code></pre>
</div>
</div>
</div>
<div id="tabset-10-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-5-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2032_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2032_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2032_2)<span class="sc">$</span>vector</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2032_2, <span class="fu">V</span>(MC2_graph_2032_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Logistics Ltd. Liability Co"</code></pre>
</div>
</div>
</div>
<div id="tabset-10-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-6-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2033_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2033_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2033_2)<span class="sc">$</span>vector</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2033_2, <span class="fu">V</span>(MC2_graph_2033_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Playa del Mar NV"          "West Bengal   Ltd Pelican"</code></pre>
</div>
</div>
</div>
<div id="tabset-10-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-7-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_2034_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_2034_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_2034_2)<span class="sc">$</span>vector</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_2034_2, <span class="fu">V</span>(MC2_graph_2034_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "West Bengal   Ltd Pelican" "hǎi dǎn Corporation Wharf"</code></pre>
</div>
</div>
</div>
<div id="tabset-10-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-8-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span> (<span class="dv">1234</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>top10_graph <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">eigen_centrality</span>(MC2_graph_combined_2)<span class="sc">$</span>vector,<span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(MC2_graph_combined_2)<span class="sc">$</span>size <span class="ot">=</span> <span class="fu">eigen_centrality</span>(MC2_graph_combined_2)<span class="sc">$</span>vector</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>agg_graph <span class="ot">&lt;-</span> <span class="fu">delete_vertices</span>(MC2_graph_combined_2, <span class="fu">V</span>(MC2_graph_combined_2)[size <span class="sc">&lt;</span> top10_graph[<span class="dv">10</span>]])</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>layout1 <span class="ot">&lt;-</span> <span class="fu">layout_with_fr</span>(agg_graph)</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>quantile_graph_aggregated <span class="ot">&lt;-</span> <span class="fu">quantile</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="co"># To identify the high centrality nodes </span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>], <span class="st">"orangered"</span>, <span class="st">"skyblue"</span>)</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(agg_graph)<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="st">"grey"</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">/</span><span class="fl">0.05</span> </span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(agg_graph)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">ifelse</span> (<span class="fu">V</span>(agg_graph)<span class="sc">$</span>size<span class="sc">*</span><span class="fl">0.05</span> <span class="sc">&gt;</span> quantile_graph_aggregated[<span class="dv">10</span>],<span class="fu">V</span>(agg_graph)<span class="sc">$</span>id,<span class="cn">NA</span>)</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(agg_graph, <span class="at">edge.arrow.size=</span><span class="fl">0.35</span>,<span class="at">edge.arrow.mode =</span> <span class="st">"-"</span>, <span class="at">vertex.label =</span> <span class="fu">V</span>(agg_graph)<span class="sc">$</span>label, <span class="at">vertex.label.cex =</span> <span class="fl">0.5</span>, <span class="at">vertex.label.font =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"HSCODE 304620 - Eigenvector centrality graph"</span> ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below are the nodes that are the top 10% nodes in terms of eigenvector centrality score:</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label[<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">V</span>(agg_graph)<span class="sc">$</span>label)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Logistics Ltd. Liability Co" "Playa del Mar NV"           
[3] "West Bengal   Ltd Pelican"   "hǎi dǎn Corporation Wharf"  
[5] "Mar de la Vida Incorporated"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="plot-analysis" class="level2">
<h2 class="anchored" data-anchor-id="plot-analysis">4.3 Plot Analysis</h2>
<p>Based on the plot above, it is observed the number of nodes that have high eigenvector centrality scores are higher in hscode 304620 as compared to 630900.</p>
<section id="hscode-304620-2" class="level3">
<h3 class="anchored" data-anchor-id="hscode-304620-2">4.3.1 HSCode 304620</h3>
<p>In hscode 304620, node <strong>Mar del Este CJSC</strong> remained to the top 10% that consist of high eigenvector centrality score from 2028 till 2034. However the score is not consistent as we can see based on the size of the node from the plot, <strong>Mar del Este CJSC</strong> score was low in 2031 and increase again in 2034. This can be inferred that <strong>Mar del Este CJSC</strong> might have the habit of changing trading partner across the years.</p>
<p>Below codes are used to check the change in distinct trading partner across the years for <strong>Mar del Este CJSC</strong> as a <strong>target</strong> and <strong>source</strong> respectivly.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Target</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Source</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>edge_try <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2028"</span>, source<span class="sc">!=</span>target, target <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span> , hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>edge_try2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2029"</span>, source<span class="sc">!=</span>target, target <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>edge_try3 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2030"</span>, source<span class="sc">!=</span>target, target <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>edge_try4 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2031"</span>, source<span class="sc">!=</span>target, target <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>edge_try5 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2032"</span>, source<span class="sc">!=</span>target, target <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>edge_try6 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2033"</span>, source<span class="sc">!=</span>target, target <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>edge_try7 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2034"</span>, source<span class="sc">!=</span>target, target <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(target, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(source)) <span class="sc">%&gt;%</span></span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a>edges_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(edge_try</span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>                                   , edge_try2</span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>                                   , edge_try3</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>                                   , edge_try4</span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>                                   , edge_try5</span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a>                                   , edge_try6</span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a>                                   , edge_try7) </span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a>edges_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  target            hscode  Year weights sumgoods tradingpartner
  &lt;chr&gt;             &lt;chr&gt;  &lt;dbl&gt;   &lt;int&gt;    &lt;dbl&gt;          &lt;int&gt;
1 Mar del Este CJSC 304620  2028     430 27453885             39
2 Mar del Este CJSC 304620  2029     308 20630585             30
3 Mar del Este CJSC 304620  2030     473 35697495             38
4 Mar del Este CJSC 304620  2031     697 47716330             31
5 Mar del Este CJSC 304620  2032     539 46009350             27
6 Mar del Este CJSC 304620  2033     528 56713540             24
7 Mar del Este CJSC 304620  2034     278 25580780             22</code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>edge_try <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2028"</span>, source<span class="sc">!=</span>target, source <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span> , hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(source, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>edge_try2 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2029"</span>, source<span class="sc">!=</span>target, source <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(source, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>edge_try3 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2030"</span>, source<span class="sc">!=</span>target, source <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(source, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>edge_try4 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2031"</span>, source<span class="sc">!=</span>target, source <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(source, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>edge_try5 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2032"</span>, source<span class="sc">!=</span>target, source <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(source, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>edge_try6 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2033"</span>, source<span class="sc">!=</span>target, source <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(source, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a>edge_try7 <span class="ot">&lt;-</span> MC2_edges <span class="sc">%&gt;%</span></span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="st">"2034"</span>, source<span class="sc">!=</span>target, source <span class="sc">==</span> <span class="st">"Mar del Este CJSC"</span>, hscode <span class="sc">==</span> <span class="dv">304620</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(source, hscode, Year) <span class="sc">%&gt;%</span></span>
<span id="cb116-52"><a href="#cb116-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>(), <span class="at">sumgoods =</span> <span class="fu">sum</span>(valueofgoodsusd), <span class="at">tradingpartner =</span> <span class="fu">n_distinct</span>(target)) <span class="sc">%&gt;%</span></span>
<span id="cb116-53"><a href="#cb116-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(tradingpartner)) <span class="sc">%&gt;%</span></span>
<span id="cb116-54"><a href="#cb116-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sumgoods)) <span class="sc">%&gt;%</span></span>
<span id="cb116-55"><a href="#cb116-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb116-56"><a href="#cb116-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-57"><a href="#cb116-57" aria-hidden="true" tabindex="-1"></a>edges_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(edge_try</span>
<span id="cb116-58"><a href="#cb116-58" aria-hidden="true" tabindex="-1"></a>                                   , edge_try2</span>
<span id="cb116-59"><a href="#cb116-59" aria-hidden="true" tabindex="-1"></a>                                   , edge_try3</span>
<span id="cb116-60"><a href="#cb116-60" aria-hidden="true" tabindex="-1"></a>                                   , edge_try4</span>
<span id="cb116-61"><a href="#cb116-61" aria-hidden="true" tabindex="-1"></a>                                   , edge_try5</span>
<span id="cb116-62"><a href="#cb116-62" aria-hidden="true" tabindex="-1"></a>                                   , edge_try6</span>
<span id="cb116-63"><a href="#cb116-63" aria-hidden="true" tabindex="-1"></a>                                   , edge_try7) </span>
<span id="cb116-64"><a href="#cb116-64" aria-hidden="true" tabindex="-1"></a>edges_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 6
# ℹ 6 variables: source &lt;chr&gt;, hscode &lt;chr&gt;, Year &lt;dbl&gt;, weights &lt;int&gt;,
#   sumgoods &lt;dbl&gt;, tradingpartner &lt;int&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>From the result above, it is observed that <strong>Mar del Este CJSC</strong> is not a <strong>source</strong> for hscode 304620. While being a <strong>target</strong>, it is observed the number of distinct trading partners was dropped to 31 in 2031 as compared to a high of 39 trading partners in 2028. Based on the earlier network graph plot, it is also observed that the number of nodes that are the top 10% are also decreasing in count as the graph plotted are simplified over the years. This might be due to the increase in restrictions &amp; capturing of illegal activities happened for hscode 304620 trading activities, leading to the decrease in trading partners overall.</p>
</section>
<section id="hscode-630900-2" class="level3">
<h3 class="anchored" data-anchor-id="hscode-630900-2">4.3.1 HSCode 630900</h3>
<p>While for 630900, compared to 304620, the nodes that are involved and highlighted to be the top 10% of eigenvector centrality score appeared to be lesser. From the above network graph plots, it is observed that the trading partners of those highlighted nodes started from having interaction with one another. Nearing to the latest trend in 2034, it is observed that each highlighted nodes with high eigenvector centrality score have their own distinct trading partners that do not have interaction with one another. This might be due to the selective or pre-agreed contract that limits the organizations trading partners in the same hscode in order to remain consistent and vigilant.</p>
</section>
</section>
<section id="insights-and-learning-points" class="level2">
<h2 class="anchored" data-anchor-id="insights-and-learning-points">5. Insights and Learning points</h2>
<p>Throughout this exercise, the ability to use network graph allow the users to have a visualization on the connection between the different organizations. Patterns observed above can be highlighted to see if similar patterns such as reducing in trading partners or isolating trading partners are signs of potential illegal activities involvement.</p>
<p>To further improve the analysis, known illegal organizations are suggested to be identified first in order to allow the analyst to study the patterns and behavior of such organizations. With this information, other analysis such as correlation between value goods traded and potential illegal organizations can be carried out. The patterns observed would allow analysts to identify potential illegal organizations more accurately.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>