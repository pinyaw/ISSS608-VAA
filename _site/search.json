[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "Hands_on_Ex/Hands-on_Ex01/Hands-on_Ex01.html",
    "href": "Hands_on_Ex/Hands-on_Ex01/Hands-on_Ex01.html",
    "title": "Hands-on Exercise 1",
    "section": "",
    "text": "The code chunk below uses p_load() of pacman package to check if tidyverse packages are installed in the computer. If they are, then they will be launched into R.\n\npacman::p_load(tidyverse)\n\n\n\n\n\nexam_data &lt;- read_csv(\"data/Exam_data.csv\")\n\nRows: 322 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): ID, CLASS, GENDER, RACE\ndbl (3): ENGLISH, MATHS, SCIENCE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "Hands_on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#install-and-launching-r-packages",
    "href": "Hands_on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#install-and-launching-r-packages",
    "title": "Hands-on Exercise 1",
    "section": "",
    "text": "The code chunk below uses p_load() of pacman package to check if tidyverse packages are installed in the computer. If they are, then they will be launched into R.\n\npacman::p_load(tidyverse)"
  },
  {
    "objectID": "Hands_on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#importing-data",
    "href": "Hands_on_Ex/Hands-on_Ex01/Hands-on_Ex01.html#importing-data",
    "title": "Hands-on Exercise 1",
    "section": "",
    "text": "exam_data &lt;- read_csv(\"data/Exam_data.csv\")\n\nRows: 322 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): ID, CLASS, GENDER, RACE\ndbl (3): ENGLISH, MATHS, SCIENCE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "Hands_on_Ex/Hands-on_Ex03/Hands-on_Ex03.html",
    "href": "Hands_on_Ex/Hands-on_Ex03/Hands-on_Ex03.html",
    "title": "Hands_on_Ex03",
    "section": "",
    "text": "Tableau Page Link:\nhttps://public.tableau.com/app/profile/pin6699/viz/HandsOn_Ex03/Dashboard_Ex03?publish=yes"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS608-VAA",
    "section": "",
    "text": "Welcome to ISSS608 Visual Analytics and Applications. In this website, you will find my coursework prepared for this course.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex01/In-class_Ex01.html",
    "href": "In_class_Ex/In-class_Ex01/In-class_Ex01.html",
    "title": "In-Class_Ex01",
    "section": "",
    "text": "Tableau Page Link:\nhttps://public.tableau.com/app/profile/pin6699/viz/TableauStart_16815426006770/Dashboard1?publish=yes"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex03/In-class_Ex03.html",
    "href": "In_class_Ex/In-class_Ex03/In-class_Ex03.html",
    "title": "In-Class Exercise 3",
    "section": "",
    "text": "Tableau Page Link:\nhttps://public.tableau.com/app/profile/pin6699/viz/In-class-Ex03_YapPinYaw/SalesversusProfit?publish=yes"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex04/In-class_Ex04.html",
    "href": "In_class_Ex/In-class_Ex04/In-class_Ex04.html",
    "title": "In-Class Ex04",
    "section": "",
    "text": "pacman::p_load(rstatix, gt, patchwork, tidyverse, webshot2, ggstatsplot)"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#load-packages",
    "href": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#load-packages",
    "title": "In-Class Ex04",
    "section": "",
    "text": "pacman::p_load(rstatix, gt, patchwork, tidyverse, webshot2, ggstatsplot)"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#import-data",
    "href": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#import-data",
    "title": "In-Class Ex04",
    "section": "Import Data",
    "text": "Import Data\n\nexam_data &lt;- read_csv(\"data/Exam_data.csv\")"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#visualising-normal-distribution",
    "href": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#visualising-normal-distribution",
    "title": "In-Class Ex04",
    "section": "Visualising Normal Distribution",
    "text": "Visualising Normal Distribution\nIf the data is normally distributed, the points in a Q-Q plot will lie on a straight diagonal line. Conversely, if the points deviate significantly from the straight diagonal line, then it’s less likely that the data is normally distributed.\n\nThe plotThe code chunk\n\n\n\n\n\n\n\n\n\n\nggplot(exam_data,\n       aes(sample=ENGLISH)) +\n  stat_qq() +\n  stat_qq_line()\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nWe can see that the points deviate significantly from the straight diagonal line. This is a clear indication that the set of data is not normally distributed.\n\n\n\nCombining Statistical graph and analysis table\n\nThe plotThe code chunk\n\n\n\n\n\n\n\n\n\n\nqq &lt;- ggplot(exam_data,\n             aes(sample=ENGLISH)) +\n stat_qq() +\n stat_qq_line()\n\nsw_t &lt;- exam_data %&gt;%\n  shapiro_test(ENGLISH) %&gt;%\n  gt()\n\ntmp &lt;- tempfile(fileext = '.png')\ngtsave(sw_t, tmp)\ntable_png &lt;- png::readPNG(tmp,native = TRUE)\n\nqq + table_png"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#student-t-test-using-a-histogram-for-english",
    "href": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#student-t-test-using-a-histogram-for-english",
    "title": "In-Class Ex04",
    "section": "Student T-test using a Histogram for ENGLISH",
    "text": "Student T-test using a Histogram for ENGLISH\n\nset.seed(1234)\n\ngghistostats(\n  data = exam_data,\n  x = ENGLISH,\n  type = \"p\",\n  test.value = 60,\n  xlab = \"English scores\"\n)"
  },
  {
    "objectID": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#welch-test-for-maths",
    "href": "In_class_Ex/In-class_Ex04/In-class_Ex04.html#welch-test-for-maths",
    "title": "In-Class Ex04",
    "section": "Welch test for MATHS",
    "text": "Welch test for MATHS\n\nggbetweenstats(\n  data = exam_data,\n  x = GENDER, \n  y = MATHS,\n  type = \"p\",\n  messages = FALSE\n)"
  },
  {
    "objectID": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html",
    "href": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html",
    "title": "Take Home Exercise 1",
    "section": "",
    "text": "City of Engagement, with a total population of 50,000, is a small city located at Country of Nowhere. The city serves as a service centre of an agriculture region surrounding the city. The main agriculture of the region is fruit farms and vineyards. The local council of the city is in the process of preparing the Local Plan 2023. A sample survey of 1000 representative residents had been conducted to collect data related to their household demographic and spending patterns, among other things. The city aims to use the data to assist with their major community revitalization efforts, including how to allocate a very large city renewal grant they have recently received."
  },
  {
    "objectID": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#load-packages",
    "href": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#load-packages",
    "title": "Take Home Exercise 1",
    "section": "5.1 Load Packages",
    "text": "5.1 Load Packages\n\n\nCode\npacman::p_load(rstatix, gt, patchwork, tidyverse, webshot2, ggstatsplot, dplyr, plotly, ggplot2, reshape2, readr, matrixStats, ggiraph, lessR, formattable, scales, ggmosaic, ggridges, lubridate, ggstatsplot, ggpubr, GGally, corrplot)"
  },
  {
    "objectID": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#import-data",
    "href": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#import-data",
    "title": "Take Home Exercise 1",
    "section": "5.2 Import Data",
    "text": "5.2 Import Data\n\n\nCode\nparticipants_df &lt;- read_csv(\"data/Participants.csv\")\nfinance_df &lt;- read_csv(\"data/FinancialJournal.csv\")"
  },
  {
    "objectID": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-issue",
    "href": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-issue",
    "title": "Take Home Exercise 1",
    "section": "5.3 Data Issue",
    "text": "5.3 Data Issue\n\n5.3.1 Data Duplication\nTo prevent any double counting of a similar event, data duplication check and removal are to be executed to ensure higher data accuracy. Feel free to view the codes below that are being used to removal duplication.\n\n\nCode\nparticipants_df2 &lt;- participants_df %&gt;% distinct()\nfinance_df2 &lt;- finance_df %&gt;% distinct()"
  },
  {
    "objectID": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-aggregation",
    "href": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#data-aggregation",
    "title": "Take Home Exercise 1",
    "section": "5.4 Data Aggregation",
    "text": "5.4 Data Aggregation"
  },
  {
    "objectID": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#demographics",
    "href": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#demographics",
    "title": "Take Home Exercise 1",
    "section": "6.1 Demographics",
    "text": "6.1 Demographics\nLet us understand more about the paticipants before we delve into their respective financial health.\n\n6.1.1 Education Level\nBased on the pie chart below, we can observe that the survey participants are mainly consists of HighSchoolOrCollege education level (51.9%), followed by Bachelors, Graduate and Low. Therefore, moving forward analyses conducted after have to take into account of this information.\n\n\nCode\neducount &lt;-table(participants_df2$educationLevel)\npercentage_edu &lt;- educount/ sum(educount)\npercentage_edu_labels &lt;- paste0(round(percentage_edu*100),\"%\")\ndf_edu &lt;- data.frame(educount,percentage_edu,percentage_edu_labels)\n\n#Change column names\ncolnames(df_edu)[1] &lt;- \"educationLevel\"\ncolnames(df_edu)[2] &lt;- \"Count\"\ncolnames(df_edu)[3] &lt;- \"educationLevel2\"\ncolnames(df_edu)[4] &lt;- \"percentage_edu\"\n\nfig_edu &lt;- df_edu |&gt; \n  plot_ly() |&gt; \n  add_trace(\n    labels = ~educationLevel,\n    values = ~Count, \n    type = \"pie\") %&gt;%\n  layout(title = 'Education Level Distribution', plot_bgcolor = \"#e5ecf6\")\nfig_edu\n\n\n\n\n\n\n\n\n6.1.2 Do higher educated participants tend to not have kids?\nIt can be observed that HighSchoolOrCollege have the highest percentage as well as the count for participants who have kids from the provided data. Bachechors and Graduate participants have a slightly higher percentage of haveKids = False within their own groups as compared to the Low education participants.\nFrom the width of the Mosaic plot, HighSchoolOrCollege has the highest participants count and Low education has the least participants. Assuming the participants here are the representation of the whole population of the city, we can conclude that lower education participants indeed have a higher tendency to have kids, while higher qualification participants would weigh in the cost of having kids and hence chose not to have kids.\n\n\nCode\nd &lt;- ggplot(participants_df2) +\n  geom_mosaic(aes(x = product(educationLevel), fill = haveKids)) +\n  scale_y_continuous(limits = c(0, 1.0))\n\nggplotly(d, tooltip =\"y\")\n\n\n\n\n\n\n\n\n6.1.3 Do higher educated participants have a higher wage income?\nTo further understand the demographics of the participants, age groups are being formed such that we can analyse the patterns and trends exhibit by the similar age group of people.\nThe age data provided is in continuous form, therefore the age data is being regrouped into 4 distinct groups. The 4 groups presented are : (1) Group age 18 – 30 participants (2) Group age 31 – 40 participants (3) Group age 41- 50 participants (4) Group age Above 50 participants.\n\nRegrouping Code\n\n\nCode\ndf_regrouped &lt;- participants_df2 %&gt;%\n  mutate(age_group = case_when(\n    age &lt;= 35 ~ \"Group 18 - 30\",\n    age &lt;= 40 ~ \"Group 31 - 40\",\n    age &lt;= 50 ~ \"Group 41 - 50\",\n    TRUE ~ \"Group Above 50\"\n  ))\ndf_regrouped\n\n\n# A tibble: 1,011 × 8\n   participantId householdSize haveKids   age educationLevel      interestGroup\n           &lt;dbl&gt;         &lt;dbl&gt; &lt;lgl&gt;    &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;        \n 1             0             3 TRUE        36 HighSchoolOrCollege H            \n 2             1             3 TRUE        25 HighSchoolOrCollege B            \n 3             2             3 TRUE        35 HighSchoolOrCollege A            \n 4             3             3 TRUE        21 HighSchoolOrCollege I            \n 5             4             3 TRUE        43 Bachelors           H            \n 6             5             3 TRUE        32 HighSchoolOrCollege D            \n 7             6             3 TRUE        26 HighSchoolOrCollege I            \n 8             7             3 TRUE        27 Bachelors           A            \n 9             8             3 TRUE        20 Bachelors           G            \n10             9             3 TRUE        35 Bachelors           D            \n# ℹ 1,001 more rows\n# ℹ 2 more variables: joviality &lt;dbl&gt;, age_group &lt;chr&gt;\n\n\nBased on the boxplot below, we can observe that Group 18-30 has a closer median and mean as compared to Group 31-40, while Group 41-50 has a closer median and mean with Group Above 50. Judging by the lines of the boxplot, the higher age groups (41 and above) tends to have a lower average of joviality while participating in this survey. This might be due to the higher commitments as well as higher responsibilities.\n\n\nBoxplot Code\n\n\nCode\nplot_ly(\n  data = df_regrouped,\n  y = ~joviality,\n  x = ~age_group,\n  type = \"box\",\n  boxmean = TRUE,\n  color = ~age_group,\n  showlegend = FALSE,\n  boxpoints = \"all\"\n) %&gt;%\nlayout(title = 'Joviality boxplots across each age group')"
  },
  {
    "objectID": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#financial-health",
    "href": "Take_Home_Ex/Take-home_Ex01/Take-home_Ex01.html#financial-health",
    "title": "Take Home Exercise 1",
    "section": "6.2 Financial Health",
    "text": "6.2 Financial Health\n\n6.2.1 Do participants with kids have a higher cost of living?\nTo determine if cost is higher for participants with kids, the below boxplot was plotted to see the distribution of each type of cost grouped by participants’ haveKids status. Education cost is only present for participants who have kids. In addition, Shelter Cost’s Mean and median is also appeared to be higher than for participants who have kids as they need to have a larger space as well as a permanent space for a more comfortable living environment for the kids.\nOn the flip side, the distribution for Food and Recreation Cost seems to be similar. Participants with kids have a higher median for Recreation Cost, most likely due to the additional cost for children (cheaper than an adult) for all the recreational activities. As for Food, not much difference can be observed between participants with or without kids.\n\n\nCode\ndf_cat1 &lt;- subset(finance_df2, select = -c(timestamp) )\n\n# summation of the amount based on ID and category\ndf_cat2 &lt;- df_cat1 %&gt;%\n  group_by(participantId, category) %&gt;%\n  summarize(amount = sum(amount))\n\n# To exclude Wage and RentAdjustment as they are income\ndf_cat &lt;- df_cat2[!(df_cat2$category %in% c(\"Wage\",\"RentAdjustment\")), ]\n\n# change negative values to positive so as to be able to show the Cost in positive numbers\ndf_cat &lt;- df_cat %&gt;% mutate(across(.cols = c(amount), .fns = abs))\n\n# Join participant demographic data\njoined_df &lt;- inner_join(participants_df2, df_cat, by = \"participantId\")\n\n#Boxplot\npp &lt;-ggplot(joined_df, aes(x = haveKids, y = amount, fill = category)) +\n  geom_boxplot() +\n  theme_classic() +\n  scale_y_continuous(name = \"Cost Amount\")\nggplotly(pp)%&gt;%layout(boxmode = \"group\")\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nWithout the boxmode in ggplotly, the boxplots under each group will be combined together under one line of plot. It would be harder for the readers to have a sense where does the different categories stand. Hence it is necessary to add in the boxmode = \"group\" to have the above view.\n\n\n\n\n6.2.2 Does higher wage earner tend to have a higher cost of living?\nThe below scatter plot showed the best fit line across the distribution. However, we can observe clearly that distribution data points are mainly situated nearer to the lower income section. To further validate this test, correlation coefficient significant test is being carried out at 95% confidence interval.\n\nH0: There is no significant correlation between the variables\n\n\nH1: The correlation between the variables is statistically significant\nFrom a statistical point of view, the p-value computed was less than 0.05, therefore we have sufficient evidence to reject H0 and conclude that there is a correlation between wage cost of living. However, the expectation is different as they are negatively correlated. From the data points, it is observed that there are a significant number of residents who are having a higher cost of living despite having a lower wage, while the top wage earners’ cost of living remained below 10000 over the period.\n\n\nCode\n#Remove timestamp\ndf_cat1 &lt;- subset(finance_df2, select = -c(timestamp) )\n\n# summation of the amount based on ID and category\ndf_income_cost1 &lt;- df_cat1 %&gt;%\n  group_by(participantId, category) %&gt;%\n  summarize(amount = sum(amount))\n\n# To regroup into Income and Cost\ndf_income_cost1 &lt;- df_income_cost1 %&gt;%\n  mutate(Type = case_when(\n    category == \"Wage\" ~ \"Income\",\n    category == \"RentAdjustment\" ~ \"Income\",\n    TRUE ~ \"Cost\"\n  ))\ndf_income_cost1 &lt;- subset(df_income_cost1, select = -c(category) )\n\ndf_income_cost1 &lt;- df_income_cost1 %&gt;%\n  group_by(participantId, Type) %&gt;%\n  summarize(amount = sum(amount))\n\n# change negative values to positive so as to be able to show the Cost in positive numbers\ndf_income_cost1 &lt;- df_income_cost1 %&gt;% mutate(across(.cols = c(amount), .fns = abs))\n\ndf_income_cost_final &lt;- pivot_wider(df_income_cost1, names_from = Type, values_from = amount, values_fn = sum)\n\n# Perform bivariate test\nfit &lt;- lm(Cost ~ Income, data = df_income_cost_final)\np_val &lt;- summary(fit)$coefficients[2, 4]\n\n# Create scatter plot with regression line and confidence intervals\nggscatter(df_income_cost_final, x = \"Income\", y = \"Cost\", \n          add = \"reg.line\", conf.int = TRUE, \n          cor.coef = TRUE, cor.method = \"pearson\", \n          cor.plot = TRUE, cor.coef.digits = 2) +\n  stat_regline_equation(aes(label = paste(..eq.label.., ..rr.label.., sep = \"~~~\")),\n                       label.x.npc = 0.5, label.y.npc = 0.98) \n\n\n\n\n\nCode\n          #annotate(\"text\", x = 50000, y = 1000, label = paste(\"p-value = \", p_val))\n\n\nTherefore, higher income individuals do not mean they will be spending more, while lower income individuals might have a high cost of living due to the need of supporting his family or with the presence of kids.\n\n\n\n6.2.3 Participants with higher wage income tends to have higher joviality.\nFrom the below scatterplot, it seemed that they are negatively correlated. To further validate this test, correlation coefficient significant test is being carried out at 95% confidence interval.\n\nH0: There is no significant correlation between the variables\n\n\nH1: The correlation between the variables is statistically significant\nThe test has shown a p-value less than 0.05, therefore we have sufficient evidence to reject H0 and conclude that there is a linear relationship and a negative correlation between the wage income and joviality. Thus, proving that higher wage income does not mean that they are happy with their current state.\n\n\nCode\n#Remove timestamp\ndf_wage1 &lt;- subset(finance_df2, select = -c(timestamp) )\n\n# summation of the amount based on ID and category\ndf_wage1 &lt;- df_wage1 %&gt;%\n  group_by(participantId, category) %&gt;%\n  summarize(amount = sum(amount))\n\n# To regroup into Income and Cost\ndf_wage1 &lt;- df_wage1 %&gt;%\n  mutate(Type = case_when(\n    category == \"Wage\" ~ \"Income\",\n    category == \"RentAdjustment\" ~ \"Income\",\n    TRUE ~ \"Cost\"\n  ))\ndf_wage1 &lt;- subset(df_wage1, select = -c(category) )\n\ndf_wage1 &lt;- df_wage1 %&gt;%\n  group_by(participantId, Type) %&gt;%\n  summarize(amount = sum(amount))\n\n# change negative values to positive so as to be able to show the Cost in positive numbers\ndf_wage1 &lt;- df_wage1 %&gt;% mutate(across(.cols = c(amount), .fns = abs))\n\ndf_wage_final &lt;- pivot_wider(df_wage1, names_from = Type, values_from = amount, values_fn = sum)\n\n# Join participant demographic data\njoined_df &lt;- inner_join(participants_df2, df_wage_final, by = \"participantId\")\n\n# Perform bivariate test\nfit &lt;- lm(joviality ~ Income, data = joined_df)\np_val &lt;- summary(fit)$coefficients[2, 4]\n\n# Create scatter plot with regression line and confidence intervals\nggscatter(joined_df, x = \"joviality\", y = \"Income\", \n          add = \"reg.line\", conf.int = TRUE, \n          cor.coef = TRUE, cor.method = \"pearson\", \n          cor.plot = TRUE, cor.coef.digits = 2) +\n  stat_regline_equation(aes(label = paste(..eq.label.., ..rr.label.., sep = \"~~~\")),\n                       label.x.npc = 0.5, label.y.npc = 0.98) \n\n\n\n\n\nCode\n          #annotate(\"text\", x = 50000, y = 1000, label = paste(\"p-value = \", p_val))\n\n\n\n\n\n6.2.4 Do higher educated participants have a higher wage income?\nBased on the below plotted graph, we can see that participants with Bachelors and Graduate degree tend to have a higher mean as well as median. Despite the outlier in both groups, the medians still observed to be higher.\nwe proceed to perform the non-parametric test at 95% confidence interval using the Kruskal-Wallis.\n\nH0: The average wage income across each education group is the same.\n\n\nH1: The average wage income across each education group is not all the same.\n\n\nCode\n#Remove timestamp\ndf_edu1 &lt;- subset(finance_df2, select = -c(timestamp) )\n\n# summation of the amount based on ID and category\ndf_edu1 &lt;- df_edu1 %&gt;%\n  group_by(participantId, category) %&gt;%\n  summarize(amount = sum(amount))\n\n# To regroup into Income and Cost\ndf_edu1 &lt;- df_edu1 %&gt;%\n  mutate(Type = case_when(\n    category == \"Wage\" ~ \"Income\",\n    category == \"RentAdjustment\" ~ \"Income\",\n    TRUE ~ \"Cost\"\n  ))\ndf_edu1 &lt;- subset(df_edu1, select = -c(category) )\n\ndf_edu1 &lt;- df_edu1 %&gt;%\n  group_by(participantId, Type) %&gt;%\n  summarize(amount = sum(amount))\n\n# change negative values to positive so as to be able to show the Cost in positive numbers\ndf_edu1 &lt;- df_edu1 %&gt;% mutate(across(.cols = c(amount), .fns = abs))\n\ndf_edu_final &lt;- pivot_wider(df_edu1, names_from = Type, values_from = amount, values_fn = sum)\n\n# Join participant demographic data\njoined_df &lt;- inner_join(participants_df2, df_edu_final, by = \"participantId\")\n\nggbetweenstats(\n  data = joined_df,\n  x    = educationLevel, \n  y    = Income, \n  type = \"nonparametric\")\n\n\n\n\n\nThe p-value of the Kruskal-Wallis test is lower than 0.05, therefore we have sufficient evidence to reject H0 that the average wage income is similar across different educational groups, and participants with higher education qualification have higher wage income."
  }
]